"use strict";var moment=require("moment"),Time={genTimestamp:function(e){var t=(new Date).getTime();return e?t:t.toString(36).toUpperCase()},parseTimestamp:function(e){return Number.isInteger(+e)?new Date(+e):new Date(parseInt(e,36))}},uuidv4=require("uuid/v4"),uuidv5=require("uuid/v5"),isUUID=require("is-uuid"),sha1=require("uuid/lib/sha1-browser.js"),Tool={genUUID_v4:function(){return uuidv4()},genUUID_v5:function(e){if(36!==(t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"f8061fba-842b-4cc5-9872-9348e2e06916").length)var t=uuidv5(t,"f8061fba-842b-4cc5-9872-9348e2e06916");return uuidv5(e,t)},genSHA1:function(e){return t=sha1(e),Array.from(t,function(e){return("0"+(255&e).toString(16)).slice(-2)}).join("");var t},formatUUID:function(e){var t="";return t+=(e=e.toLowerCase()).slice(0,8)+"-",t+=e.slice(8,12)+"-",t+=e.slice(12,16)+"-",t+=e.slice(16,20)+"-",t+=e.slice(20,36)},checkUUID:function(e){for(var t=[isUUID.v4,isUUID.v5,isUUID.v3,isUUID.v2,isUUID.v1],r=[4,5,3,2,1],n=0;n<t.length;n++)if(t[n](e))return r[n];return 0},roll:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.floor(Math.random()*(e-t+1)+t)},rollString:function(e,t){for(var r="",n=t||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<e;o++)r+=n.charAt(Math.floor(Math.random()*n.length));return r}},fs=require("fs"),path=require("path"),fsex=require("fs-extra"),os=require("os"),moment$1=require("moment"),NodeFile={getTempDirManager:function(e){var t=os.tmpdir(),r=path.join(t,e);fsex.ensureDirSync(r);var n=Time.genTimestamp(),o=path.join(r,n);return fsex.ensureDirSync(o),{tempDir:o,mianTempDir:r,timestamp:n,destroy:function(){fsex.removeSync(this.tempDir)},clear:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=new Date,r=fs.readdirSync(this.mianTempDir),o=0;o<r.length;o++){var i=r[o];if(i!=n){var l=path.join(this.mianTempDir,i),u=fs.statSync(l);moment$1(t).diff(u.mtime,"days")>=e&&fsex.remove(l)}}},genTempFilePath:function(e){var t=this;return function r(){var n=Tool.rollString(12);if(e)var o=path.join(t.tempDir,e,n);else o=path.join(t.tempDir,n);return fsex.pathExistsSync(o)?r():o}()}}}},chalk=require("chalk"),NodeDebug={logRed:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.red(e),t)},cRed:function(e){return chalk.red(e)},logBlue:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.blue(e),t)},cBlue:function(e){return chalk.blue(e)},logGreen:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.green(e),t)},cGreen:function(e){return chalk.green(e)},logGray:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.gray(e),t)},cGray:function(e){return chalk.gray(e)},logYellow:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.yellow(e),t)},cYellow:function(e){return chalk.yellow(e)},logLableRed:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.black.bgRed(e),t)},logLableYellow:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.black.bgYellow(e),t)},logLableCyan:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.black.bgCyan(e),t)},logLableGreen:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.black.bgGreen(e),t)},logLableWhite:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.black.bgWhite(e),t)}},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},asyncToGenerator=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,i){try{var l=t[o](i),u=l.value}catch(e){return void r(e)}if(!l.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}},PNGJS=require("pngjs").PNG,fs$1=require("fs"),stream=require("stream"),streamToBuffer=require("stream-to-buffer"),NodeImage={getPngData:function(){var e=asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){if(stream.PassThrough){var n=new stream.PassThrough;n.end(t),n.pipe(new PNGJS({filterType:4})).on("parsed",function(){e(this.data)})}else new PNGJS({filterType:4}).parse(t,function(t,n){t&&r("err pngParseAsync:",t),e(n.data)})}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),ARGB_BufferToPngFileBuffer:function(e,t,r){return new Promise(function(n,o){for(var i=e.length,l=t||4,u=0;u<i;u+=l){var a=e[u];e[u]=e[u+1],e[u+1]=e[u+2],e[u+2]=e[u+3],e[u+3]=a}var f=new PNGJS({width:r.w,height:r.h});f.data=e,streamToBuffer(f.pack(),function(e,t){e&&o(e),n(t)})})}},nodeCrypto=require("crypto"),NodeTool={getMD5:function(e){var t=nodeCrypto.createHash("md5");return t.update(e),t.digest("hex")},getSHA256:function(e){var t=nodeCrypto.createHash("sha256");return t.update(e),t.digest("hex")},arrayBuffertoBuffer:function(e){for(var t=new Buffer(e.byteLength),r=new Uint8Array(e),n=0;n<t.length;++n)t[n]=r[n];return t}},ConsoleCON={CSS_POST:"background: rgb(44, 132, 226);border-radius: 2px 25px 25px 2px;padding: 2px 8px;color: rgba(255, 255, 255, 1);display: inline-block;min-width: 100px;",CSS_POST_RESULT:"background: rgb(51, 197, 138);border-radius: 25px 2px 2px 25px;padding: 2px 8px;color: rgba(255, 255, 255, 1);display: inline-block;min-width: 100px;"},ObjectOBJ={isEmptyObject:function(e){for(var t in e)return!1;return!0},objectCopyToObject:function(e,t,r,n,o,i){if(void 0!=t)for(var l in e){void 0!=i&&i(e,t,l);void 0!=r&&r(l,e[l]);var u=l;void 0!=n&&(u=n(l,e[l])),void 0!=e[l]&&e[l].constructor===Object?("object"!==_typeof(t[u])&&(t[u]={}),this.objectCopyToObject(e[l],t[u],r,n,o)):t[u]=void 0!=o?o(l,e[l]):e[l]}},getObjectValueByNames:function(e,t,r){for(var n,o=0;o<t.length-(r||0);o++)if(0==o){if(void 0==e[t[o]])return null;n=e[t[o]]}else{if(void 0==n[t[o]])return null;n=n[t[o]]}return n},setObjectValueByNames:function(e,t,r){var n;if(1!=t.length){for(var o=0;o<t.length;o++)if(0==o&&t.length>2)void 0==e[t[0]]&&(e[t[0]]={}),n=e[t[0]];else if(o<t.length-2&&t.length>2)void 0==n[t[o]]&&(n[t[o]]={}),n=n[t[o]];else if(o==t.length-2)return 2==t.length?(void 0==e[t[0]]&&(e[t[0]]={}),void((n=e[t[0]])[t[1]]=r)):(void 0==n[t[o]]&&(n[t[o]]={}),void((n=n[t[o]])[t[o+1]]=r))}else e[t[0]]=r},treeFind:function(e,t,r,n,o){if("function"==typeof t)var i=t;else i=function(e){return e.id==t};var l=function e(t,r,n,o,l){for(var u=[],a=[],f=0;f<t.length;f++){var c=t[f];if(i(c)&&(u.push(c),!o))return u;if(c[n])if(l){var h=e(c[n],r,n,o,l);if(!o&&h.length>0)return h;u=u.concat(h)}else a.push(c[n])}if(!l)for(f=0;f<a.length;f++){if(h=e(a[f],r,n,o,l),!o&&h.length>0)return h;u=u.concat(h)}return u}(e,i,r,n,o);return n?l:l.length>0?l[0]:null},treeEach:function(e,t,r,n){var o=[],i=0,l=0;return t||(t=function(e){}),function e(t,r,n,u,a){a>l&&(l=a);var f=[];for(var c=0;c<t.length;c++){i++,void 0==o[a]?o[a]=1:o[a]++;var h=t[c];if(r(h,a,o[a],i,t,c))return;if(h[n])if(u){var s=e(h[n],r,n,u,a+1);if(s)return}else f.push(h[n])}if(!u)for(var c=0;c<f.length;c++){var s=e(f[c],r,n,u,a+1);if(s)return}return}(e,t,r,n,0),{struct:o,deep:l+1,total:i}}},StringSTR={left:function(e,t){return t>=0?e.substr(0,t):this.right(e,-t)},right:function(e,t){return t>=0?e.substr(e.length-t,t):this.left(e,-t)},insert:function(e,t,r,n){return e.slice(0,t)+n+e.slice(t+Math.abs(r))}},Rect={rltb2xywh:function(e){var t={x:null,y:null,w:null,h:null};return t.x=e.left,t.y=e.top,t.h=e.bottom-e.top,t.w=e.right-e.left,t},xywh2rltb:function(e){var t={left:null,right:null,top:null,bottom:null};return t.left=e.x,t.top=e.y,t.right=e.x+e.w,t.bottom=e.y+e.h,t},paddingXywh:function(e,t){var r=Rect.xywh2rltb(e);return t.length&&4==t.length?(r.left-=t[0],r.top-=t[1],r.right+=t[2],r.bottom+=t[3],Rect.rltb2xywh(r)):(r.left-=t,r.top-=t,r.right+=t,r.bottom+=t,Rect.rltb2xywh(r))},getXywhsRange:function(e){for(var t={left:null,right:null,top:null,bottom:null},r=0;r<e.length;r++){var n=Rect.xywh2rltb(e[r]);void 0==t.left&&(t.left=n.left),void 0==t.top&&(t.top=n.top),void 0==t.right&&(t.right=n.right),void 0==t.bottom&&(t.bottom=n.bottom),n.left<t.left&&(t.left=n.left),n.top<t.top&&(t.top=n.top),n.right>t.right&&(t.right=n.right),n.bottom>t.bottom&&(t.bottom=n.bottom)}return Rect.rltb2xywh(t)},moveXywhs:function(e,t){for(var r=Rect.getXywhsRange(e),n=0;n<e.length;n++){var o=e[n];o.x=t.x+o.x-r.x,o.y=t.y+o.y-r.y}return e},xywhHasCover:function(e,t){var r=Rect.xywh2rltb(e),n=Rect.xywh2rltb(t);return!!(r.left<=n.right&&r.right>=n.left&&r.top<=n.bottom&&r.bottom>=n.top)}},TypeTYP={getType:function(e){var t={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object","[object Error]":"error"};return null===e?"null":void 0===e?"undefined":"object"===(void 0===e?"undefined":_typeof(e))||"function"==typeof e?t[t.toString.call(e)]||"object":void 0===e?"undefined":_typeof(e)}},AarryArr={symDifference:function(e,t){for(var r={},n=0;n<e.length;n++)r[e[n]]=!0;for(n=0;n<t.length;n++)void 0==r[t[n]]?r[t[n]]=!0:r[t[n]]=!1;var o=[];for(var i in r)0!=r[i]&&o.push(i);return o},symDifference_ObjectArray:function(e,t,r){for(var n={},o=0;o<e.length;o++)n[e[o][r]]={is:!0,ob:e[o]};for(o=0;o<t.length;o++)void 0==n[t[o][r]]?n[t[o][r]]={is:!0,ob:t[o]}:n[t[o][r]]={is:!1};var i=[];for(var l in n)0!=n[l].is&&i.push(n[l].ob);return i},difference:function(e,t){for(var r={},n=0;n<e.length;n++)r[e[n]]=!0;for(n=0;n<t.length;n++)void 0!=r[t[n]]&&(r[t[n]]=!1);var o=[];for(var i in r)0!=r[i]&&o.push(i);return o},union:function(e,t){for(var r={},n=0;n<e.length;n++)r[e[n]]=!0;for(n=0;n<t.length;n++)void 0==r[t[n]]&&(r[t[n]]=!0);var o=[];for(var i in r)0!=r[i]&&o.push(i);return o},intersection:function(e,t){for(var r={},n=0;n<e.length;n++)r[e[n]]=!1;for(n=0;n<t.length;n++)void 0!=r[t[n]]&&(r[t[n]]=!0);var o=[];for(var i in r)0!=r[i]&&o.push(i);return o},remove:function(e,t,r){if(r);else e=e.slice(0,e.length);for(var n=0;n<e.length;n++)t.constructor==Function?t(e[n])&&(e.splice(n,1),n--):e[n]==t&&(e.splice(n,1),n--);return e},hasMember:function(e,t,r){if(void 0==r){for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1}for(n=0;n<e.length;n++)if(r(e[n],t))return!0;return!1},getByKey:function(e,t,r,n){for(var o=0;o<e.length;o++)if(void 0!=e[o][t])if(void 0!=n){if(n(e[o][t],r))return e[o]}else if(e[o][t]==r)return e[o]},deleteByKey:function(e,t,r,n){for(var o=0;o<e.length;o++)void 0!=e[o][t]&&(void 0!=n?n(e[o][t],r)&&e.splice(o,1):e[o][t]==r&&e.splice(o,1))},sortObjectArray:function(e,t,r){if(void 0!=e&&void 0!=e.sort)return e.sort((n=t,function(e,t){var o,i;if("object"===(void 0===e?"undefined":_typeof(e))&&"object"===(void 0===t?"undefined":_typeof(t))&&e&&t)return o=e[n],i=t[n],o===i?0:(void 0===o?"undefined":_typeof(o))===(void 0===i?"undefined":_typeof(i))?r?o>i?-1:1:o<i?-1:1:(void 0===o?"undefined":_typeof(o))<(void 0===i?"undefined":_typeof(i))?-1:1;throw"error"}));var n}},Calc={},FileFIL={filterFileName:function(e,t){if(void 0!=e&&void 0!=e.length){return e=e.replace(/[\\/:*?"<>]/g,t||"")}return null}},RichangNode={Object:ObjectOBJ,String:StringSTR,Type:TypeTYP,Array:AarryArr,Rect:Rect,Console:ConsoleCON,Tool:Tool,Calc:Calc,File:FileFIL,NodeFile:NodeFile,NodeDebug:NodeDebug,NodeTool:NodeTool,NodeImage:NodeImage};module.exports=RichangNode;
