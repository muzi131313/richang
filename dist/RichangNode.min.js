"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}for(var crypto=_interopDefault(require("crypto")),moment=require("moment"),Time={genTimestamp:function(e){var r=(new Date).getTime();return e?r:r.toString(36).toUpperCase()},parseTimestamp:function(e){return Number.isInteger(+e)?new Date(+e):new Date(parseInt(e,36))}},rng=function(){return crypto.randomBytes(16)},byteToHex=[],i=0;i<256;++i)byteToHex[i]=(i+256).toString(16).substr(1);function bytesToUuid(e,r){var t=r||0,n=byteToHex;return n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+"-"+n[e[t++]]+n[e[t++]]+"-"+n[e[t++]]+n[e[t++]]+"-"+n[e[t++]]+n[e[t++]]+"-"+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]}var bytesToUuid_1=bytesToUuid;function v4(e,r,t){var n=r&&t||0;"string"==typeof e&&(r="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||rng)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,r)for(var i=0;i<16;++i)r[n+i]=o[i];return r||bytesToUuid_1(o)}var v4_1=v4;function uuidToBytes(e){var r=[];return e.replace(/[a-fA-F0-9]{2}/g,function(e){r.push(parseInt(e,16))}),r}function stringToBytes(e){e=unescape(encodeURIComponent(e));for(var r=new Array(e.length),t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}var v35=function(e,r,t){var n=function(e,n,o,i){var a=o&&i||0;if("string"==typeof e&&(e=stringToBytes(e)),"string"==typeof n&&(n=uuidToBytes(n)),!Array.isArray(e))throw TypeError("value must be an array of bytes");if(!Array.isArray(n)||16!==n.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var f=t(n.concat(e));if(f[6]=15&f[6]|r,f[8]=63&f[8]|128,o)for(var u=0;u<16;++u)o[a+u]=f[u];return o||bytesToUuid_1(f)};return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n};function sha1(e){return"function"==typeof Buffer.from?Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")):Array.isArray(e)?e=new Buffer(e):"string"==typeof e&&(e=new Buffer(e,"utf8")),crypto.createHash("sha1").update(e).digest()}var sha1_1=sha1,v5=v35("v5",80,sha1_1),v1Regex=/^[0-9a-f]{8}-[0-9a-f]{4}-[1][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,v2Regex=/^[0-9a-f]{8}-[0-9a-f]{4}-[2][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,v3Regex=/^[0-9a-f]{8}-[0-9a-f]{4}-[3][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,v4Regex=/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,v5Regex=/^[0-9a-f]{8}-[0-9a-f]{4}-[5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,nilRegex=/^[0]{8}-[0]{4}-[0]{4}-[0]{4}-[0]{12}$/i,anyRegex=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;function v1(e){return v1Regex.test(e)}function v2(e){return v2Regex.test(e)}function v3(e){return v3Regex.test(e)}function v4$1(e){return v4Regex.test(e)}function v5$1(e){return v5Regex.test(e)}function nil(e){return nilRegex.test(e)}function anyNonNil(e){return anyRegex.test(e)}var isUuid={v1:v1,v2:v2,v3:v3,v4:v4$1,v5:v5$1,nil:nil,anyNonNil:anyNonNil};function f(e,r,t,n){switch(e){case 0:return r&t^~r&n;case 1:return r^t^n;case 2:return r&t^r&n^t&n;case 3:return r^t^n}}function ROTL(e,r){return e<<r|e>>>32-r}function sha1$1(e){var r=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var n=unescape(encodeURIComponent(e));e=new Array(n.length);for(var o=0;o<n.length;o++)e[o]=n.charCodeAt(o)}e.push(128);var i=e.length/4+2,a=Math.ceil(i/16),u=new Array(a);for(o=0;o<a;o++){u[o]=new Array(16);for(var l=0;l<16;l++)u[o][l]=e[64*o+4*l]<<24|e[64*o+4*l+1]<<16|e[64*o+4*l+2]<<8|e[64*o+4*l+3]}u[a-1][14]=8*(e.length-1)/Math.pow(2,32),u[a-1][14]=Math.floor(u[a-1][14]),u[a-1][15]=8*(e.length-1)&4294967295;for(o=0;o<a;o++){for(var c=new Array(80),s=0;s<16;s++)c[s]=u[o][s];for(s=16;s<80;s++)c[s]=ROTL(c[s-3]^c[s-8]^c[s-14]^c[s-16],1);var v=t[0],g=t[1],h=t[2],d=t[3],y=t[4];for(s=0;s<80;s++){var p=Math.floor(s/20),b=ROTL(v,5)+f(p,g,h,d)+y+r[p]+c[s]>>>0;y=d,d=h,h=ROTL(g,30)>>>0,g=v,v=b}t[0]=t[0]+v>>>0,t[1]=t[1]+g>>>0,t[2]=t[2]+h>>>0,t[3]=t[3]+d>>>0,t[4]=t[4]+y>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,255&t[0],t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,255&t[1],t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,255&t[2],t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,255&t[3],t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,255&t[4]]}var sha1Browser=sha1$1,Tool={genUUID_v4:function(){return v4_1()},genUUID_v5:function(e){if(36!==(r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"f8061fba-842b-4cc5-9872-9348e2e06916").length)var r=v5(r,"f8061fba-842b-4cc5-9872-9348e2e06916");return v5(e,r)},genSHA1:function(e){return r=sha1Browser(e),Array.from(r,function(e){return("0"+(255&e).toString(16)).slice(-2)}).join("");var r},formatUUID:function(e){var r="";return r+=(e=e.toLowerCase()).slice(0,8)+"-",r+=e.slice(8,12)+"-",r+=e.slice(12,16)+"-",r+=e.slice(16,20)+"-",r+=e.slice(20,36)},checkUUID:function(e){for(var r=[isUuid.v4,isUuid.v5,isUuid.v3,isUuid.v2,isUuid.v1],t=[4,5,3,2,1],n=0;n<r.length;n++)if(r[n](e))return t[n];return 0},roll:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.floor(Math.random()*(e-r+1)+r)},rollString:function(e,r){for(var t="",n=r||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<e;o++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}},fs=require("fs"),path=require("path"),fsex=require("fs-extra"),os=require("os"),moment$1=require("moment"),NodeFile={getTempDirManager:function(e){var r=os.tmpdir(),t=path.join(r,e);fsex.ensureDirSync(t);var n=Time.genTimestamp(),o=path.join(t,n);return fsex.ensureDirSync(o),{tempDir:o,mianTempDir:t,timestamp:n,destroy:function(){fsex.removeSync(this.tempDir)},clear:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=new Date,t=fs.readdirSync(this.mianTempDir),o=0;o<t.length;o++){var i=t[o];if(i!=n){var a=path.join(this.mianTempDir,i),f=fs.statSync(a);moment$1(r).diff(f.mtime,"days")>=e&&fsex.remove(a)}}},genTempFilePath:function(e){var r=this;return function t(){var n=Tool.rollString(12);if(e)var o=path.join(r.tempDir,e,n);else o=path.join(r.tempDir,n);return fsex.pathExistsSync(o)?t():o}()}}}},chalk=require("chalk"),NodeDebug={logRed:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.red(e),r)},cRed:function(e){return chalk.red(e)},logBlue:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.blue(e),r)},cBlue:function(e){return chalk.blue(e)},logGreen:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.green(e),r)},cGreen:function(e){return chalk.green(e)},logGray:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.gray(e),r)},cGray:function(e){return chalk.gray(e)},logYellow:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.yellow(e),r)},cYellow:function(e){return chalk.yellow(e)},logLableRed:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.black.bgRed(e),r)},logLableYellow:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.black.bgYellow(e),r)},logLableCyan:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.black.bgCyan(e),r)},logLableGreen:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.black.bgGreen(e),r)},logLableWhite:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(chalk.black.bgWhite(e),r)}},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},asyncToGenerator=function(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function n(o,i){try{var a=r[o](i),f=a.value}catch(e){return void t(e)}if(!a.done)return Promise.resolve(f).then(function(e){n("next",e)},function(e){n("throw",e)});e(f)}("next")})}},toConsumableArray=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)},PNGJS=require("pngjs").PNG,fs$1=require("fs"),stream=require("stream"),streamToBuffer=require("stream-to-buffer"),NodeImage={getPngData:function(){var e=asyncToGenerator(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,t){if(stream.PassThrough){var n=new stream.PassThrough;n.end(r),n.pipe(new PNGJS({filterType:4})).on("parsed",function(){e(this.data)})}else new PNGJS({filterType:4}).parse(r,function(r,n){r&&t("err pngParseAsync:",r),e(n.data)})}));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),ARGB_BufferToPngFileBuffer:function(e,r,t){return new Promise(function(n,o){for(var i=e.length,a=r||4,f=0;f<i;f+=a){var u=e[f];e[f]=e[f+1],e[f+1]=e[f+2],e[f+2]=e[f+3],e[f+3]=u}var l=new PNGJS({width:t.w,height:t.h});l.data=e,streamToBuffer(l.pack(),function(e,r){e&&o(e),n(r)})})}},nodeCrypto=require("crypto"),NodeTool={getMD5:function(e){var r=nodeCrypto.createHash("md5");return r.update(e),r.digest("hex")},getSHA256:function(e){var r=nodeCrypto.createHash("sha256");return r.update(e),r.digest("hex")},arrayBuffertoBuffer:function(e){for(var r=new Buffer(e.byteLength),t=new Uint8Array(e),n=0;n<r.length;++n)r[n]=t[n];return r}},ConsoleCON={CSS_POST:"background: rgb(44, 132, 226);border-radius: 2px 25px 25px 2px;padding: 2px 8px;color: rgba(255, 255, 255, 1);display: inline-block;min-width: 100px;",CSS_POST_RESULT:"background: rgb(51, 197, 138);border-radius: 25px 2px 2px 25px;padding: 2px 8px;color: rgba(255, 255, 255, 1);display: inline-block;min-width: 100px;"},ObjectOBJ={isEmptyObject:function(e){for(var r in e)return!1;return!0},objectCopyToObject:function(e,r,t,n,o,i){if(void 0!=r)for(var a in e){void 0!=i&&i(e,r,a);void 0!=t&&t(a,e[a]);var f=a;void 0!=n&&(f=n(a,e[a])),void 0!=e[a]&&e[a].constructor===Object?("object"!==_typeof(r[f])&&(r[f]={}),this.objectCopyToObject(e[a],r[f],t,n,o)):r[f]=void 0!=o?o(a,e[a]):e[a]}},getObjectValueByNames:function(e,r,t){for(var n,o=0;o<r.length-(t||0);o++)if(0==o){if(void 0==e[r[o]])return null;n=e[r[o]]}else{if(void 0==n[r[o]])return null;n=n[r[o]]}return n},setObjectValueByNames:function(e,r,t){var n;if(1!=r.length){for(var o=0;o<r.length;o++)if(0==o&&r.length>2)void 0==e[r[0]]&&(e[r[0]]={}),n=e[r[0]];else if(o<r.length-2&&r.length>2)void 0==n[r[o]]&&(n[r[o]]={}),n=n[r[o]];else if(o==r.length-2)return 2==r.length?(void 0==e[r[0]]&&(e[r[0]]={}),void((n=e[r[0]])[r[1]]=t)):(void 0==n[r[o]]&&(n[r[o]]={}),void((n=n[r[o]])[r[o+1]]=t))}else e[r[0]]=t},treeFind:function(e,r,t,n,o){if("function"==typeof r)var i=r;else i=function(e){return e.id==r};var a=function e(r,t,n,o,a){for(var f=[],u=[],l=0;l<r.length;l++){var c=r[l];if(i(c)&&(f.push(c),!o))return f;if(c[n])if(a){var s=e(c[n],t,n,o,a);if(!o&&s.length>0)return s;f=f.concat(s)}else u.push(c[n])}if(!a)for(l=0;l<u.length;l++){if(s=e(u[l],t,n,o,a),!o&&s.length>0)return s;f=f.concat(s)}return f}(e,i,t,n,o);return n?a:a.length>0?a[0]:null},treeEach:function(e,r,t,n){var o=[],i=0,a=0;return r||(r=function(e){}),function e(r,t,n,f,u){u>a&&(a=u);var l=[];for(var c=0;c<r.length;c++){i++,void 0==o[u]?o[u]=1:o[u]++;var s=r[c];if(t(s,u,o[u],i,r,c))return;if(s[n])if(f){var v=e(s[n],t,n,f,u+1);if(v)return}else l.push(s[n])}if(!f)for(var c=0;c<l.length;c++){var v=e(l[c],t,n,f,u+1);if(v)return}return}(e,r,t,n,0),{struct:o,deep:a+1,total:i}},pathEach:function(e,r){!function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(var i in t){var a=t[i],f=[].concat(toConsumableArray(n),[i]);r(a,f,o),"object"===(void 0===a?"undefined":_typeof(a))&&e(a,f,o+1)}}(e,[],0)}},StringSTR={left:function(e,r){return r>=0?e.substr(0,r):this.right(e,-r)},right:function(e,r){return r>=0?e.substr(e.length-r,r):this.left(e,-r)},insert:function(e,r,t,n){return e.slice(0,r)+n+e.slice(r+Math.abs(t))}},Rect={rltb2xywh:function(e){var r={x:null,y:null,w:null,h:null};return r.x=e.left,r.y=e.top,r.h=e.bottom-e.top,r.w=e.right-e.left,r},xywh2rltb:function(e){var r={left:null,right:null,top:null,bottom:null};return r.left=e.x,r.top=e.y,r.right=e.x+e.w,r.bottom=e.y+e.h,r},paddingXywh:function(e,r){var t=Rect.xywh2rltb(e);return r.length&&4==r.length?(t.left-=r[0],t.top-=r[1],t.right+=r[2],t.bottom+=r[3],Rect.rltb2xywh(t)):(t.left-=r,t.top-=r,t.right+=r,t.bottom+=r,Rect.rltb2xywh(t))},getXywhsRange:function(e){for(var r={left:null,right:null,top:null,bottom:null},t=0;t<e.length;t++){var n=Rect.xywh2rltb(e[t]);void 0==r.left&&(r.left=n.left),void 0==r.top&&(r.top=n.top),void 0==r.right&&(r.right=n.right),void 0==r.bottom&&(r.bottom=n.bottom),n.left<r.left&&(r.left=n.left),n.top<r.top&&(r.top=n.top),n.right>r.right&&(r.right=n.right),n.bottom>r.bottom&&(r.bottom=n.bottom)}return Rect.rltb2xywh(r)},moveXywhs:function(e,r){for(var t=Rect.getXywhsRange(e),n=0;n<e.length;n++){var o=e[n];o.x=r.x+o.x-t.x,o.y=r.y+o.y-t.y}return e},xywhHasCover:function(e,r){var t=Rect.xywh2rltb(e),n=Rect.xywh2rltb(r);return!!(t.left<=n.right&&t.right>=n.left&&t.top<=n.bottom&&t.bottom>=n.top)}},TypeTYP={getType:function(e){var r={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object","[object Error]":"error"};return null===e?"null":void 0===e?"undefined":"object"===(void 0===e?"undefined":_typeof(e))||"function"==typeof e?r[r.toString.call(e)]||"object":void 0===e?"undefined":_typeof(e)}},AarryArr={symDifference:function(e,r){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;for(n=0;n<r.length;n++)void 0==t[r[n]]?t[r[n]]=!0:t[r[n]]=!1;var o=[];for(var i in t)0!=t[i]&&o.push(i);return o},symDifference_ObjectArray:function(e,r,t){for(var n={},o=0;o<e.length;o++)n[e[o][t]]={is:!0,ob:e[o]};for(o=0;o<r.length;o++)void 0==n[r[o][t]]?n[r[o][t]]={is:!0,ob:r[o]}:n[r[o][t]]={is:!1};var i=[];for(var a in n)0!=n[a].is&&i.push(n[a].ob);return i},difference:function(e,r){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;for(n=0;n<r.length;n++)void 0!=t[r[n]]&&(t[r[n]]=!1);var o=[];for(var i in t)0!=t[i]&&o.push(i);return o},union:function(e,r){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;for(n=0;n<r.length;n++)void 0==t[r[n]]&&(t[r[n]]=!0);var o=[];for(var i in t)0!=t[i]&&o.push(i);return o},intersection:function(e,r){for(var t={},n=0;n<e.length;n++)t[e[n]]=!1;for(n=0;n<r.length;n++)void 0!=t[r[n]]&&(t[r[n]]=!0);var o=[];for(var i in t)0!=t[i]&&o.push(i);return o},remove:function(e,r,t){if(t);else e=e.slice(0,e.length);for(var n=0;n<e.length;n++)r.constructor==Function?r(e[n])&&(e.splice(n,1),n--):e[n]==r&&(e.splice(n,1),n--);return e},hasMember:function(e,r,t){if(void 0==t){for(var n=0;n<e.length;n++)if(e[n]==r)return!0;return!1}for(n=0;n<e.length;n++)if(t(e[n],r))return!0;return!1},getByKey:function(e,r,t,n){for(var o=0;o<e.length;o++)if(void 0!=e[o][r])if(void 0!=n){if(n(e[o][r],t))return e[o]}else if(e[o][r]==t)return e[o]},deleteByKey:function(e,r,t,n){for(var o=0;o<e.length;o++)void 0!=e[o][r]&&(void 0!=n?n(e[o][r],t)&&e.splice(o,1):e[o][r]==t&&e.splice(o,1))},sortObjectArray:function(e,r,t){if(void 0!=e&&void 0!=e.sort)return e.sort((n=r,function(e,r){var o,i;if("object"===(void 0===e?"undefined":_typeof(e))&&"object"===(void 0===r?"undefined":_typeof(r))&&e&&r)return o=e[n],i=r[n],o===i?0:(void 0===o?"undefined":_typeof(o))===(void 0===i?"undefined":_typeof(i))?t?o>i?-1:1:o<i?-1:1:(void 0===o?"undefined":_typeof(o))<(void 0===i?"undefined":_typeof(i))?-1:1;throw"error"}));var n}},Calc={},FileFIL={filterFileName:function(e,r){if(void 0!=e&&void 0!=e.length){return e=e.replace(/[\\/:*?"<>]/g,r||"")}return null}},RichangNode={Object:ObjectOBJ,String:StringSTR,Type:TypeTYP,Array:AarryArr,Rect:Rect,Console:ConsoleCON,Tool:Tool,Calc:Calc,File:FileFIL,NodeFile:NodeFile,NodeDebug:NodeDebug,NodeTool:NodeTool,NodeImage:NodeImage};module.exports=RichangNode;
